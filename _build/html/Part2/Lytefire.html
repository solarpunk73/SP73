
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Four solaire puissant &amp; maison &#8212; SolarPunk Savoie</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/solarPunkLogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SolarPunk Savoie</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   SolarPunk Savoie
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Idées &amp; Association
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Part1/SolarPunk.html">
   SolarPunk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part1/Asso.html">
   Association
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Objectifs, réalisations &amp; idées
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="SolarBeer.html">
   Bière solaire
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CSPRecycled.html">
   Concentration solaire avec du plastique recyclé
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SolairePassif.html">
   Solaire passif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PV%26ChargeBasique.html">
   Faire un système Photovoltaïque Maison
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction à l'Energie solaire
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/IntroEnergie.html">
   Notions utiles de l’Energie
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/EmplacementSoleil.html">
   Décrire l’emplacement du soleil
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/Irradiation.html">
   L’irradiation solaire
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/LowT.html">
   Basses Températures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/mediumT.html">
   La Concentration Linéaire
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3/HighT.html">
   La Concentration Ponctuelle
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Part2/Lytefire.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/solarPunk73/solarPunk73"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/solarPunk73/solarPunk73/issues/new?title=Issue%20on%20page%20%2FPart2/Lytefire.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/solarPunk73/solarPunk73/edit/main/Part2/Lytefire.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methodologie-design-du-four">
   Méthodologie design du four
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inertie-thermique">
     Inertie thermique
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pertes-thermiques">
     Pertes thermiques
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#estimation-plus-precise">
       Estimation plus précise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimation-de-la-puissance-d-entree">
     Estimation de la puissance d’entrée
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methodologie-mathematique">
   Méthodologie mathématique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#design-des-miroirs">
     Design des miroirs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#position-optimal-a-design-donne">
     Position optimal à design donné
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cas-1-machine-face-au-soleil">
       Cas 1: Machine face au soleil
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cas-2-machine-et-four-fixe-oriente-sud">
       Cas 2: Machine et four fixe - orienté sud
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="four-solaire-puissant-maison">
<h1>Four solaire puissant &amp; maison<a class="headerlink" href="#four-solaire-puissant-maison" title="Permalink to this headline">¶</a></h1>
<p>sans implémentation automatique du tracking, il est nécessaire de faire le tracking soi-même. Par conséquent, il faut connaître les angles auxquels il faut incliner les miroirs. Dans le schéma proposé, il est possible de bouger une barre en bois (d’un angle <span class="math notranslate nohighlight">\(\beta\)</span> positif vers l’arrière) et chaque miroir <span class="math notranslate nohighlight">\(M_i\)</span> d’un angle <span class="math notranslate nohighlight">\(\alpha_i\)</span>. Comment calculer ces angles? Nous présentons ici certains calculs sensés optimiser cela, si bien faits cela s’entend. Dans un autre notebook, nous proposerons un calcul rapide de ces angles, afin de pouvoir optimiser sur le terrain. A cette fin, il est possible de faire tourner des notebooks Jupyter sur son téléphone, voir <a class="reference external" href="https://manis1604.medium.com/jupyter-notebook-for-android-6f93268e504e">ici</a>. Lien en anglais.</p>
<p><strong>/!\ /!\ : on parle ici d’une puissance élevé, cela nécessite donc de faire attention. Il est recommandé de:</strong></p>
<ol class="simple">
<li><p>Ne pas passer devant les rayons, au niveau du point focal -&gt; besoin d’une entrée par l’arrière.</p></li>
<li><p>Installer un occulteur sur les côtés et le dessus du four, afin que des rayons mal convergés n’aillent pas dans les yeux ou sur le corps des personnes manipulant le four.</p></li>
<li><p>Orienter les miroirs vers le bas lorsque non utilisé.</p></li>
<li><p>Vérifier le dégazage des matériaux de construction: des gazs peuvent être émis lors de la chauffe de matériau, il est nécessaire de se renseigner avant de les utiliser; par exemple, de la peinture dans le four semble une mauvaise idée!</p></li>
</ol>
<div class="section" id="methodologie-design-du-four">
<h2>Méthodologie design du four<a class="headerlink" href="#methodologie-design-du-four" title="Permalink to this headline">¶</a></h2>
<p>Les questions à se poser pour le four sont:</p>
<ol class="simple">
<li><p>Son inertie thermique</p></li>
<li><p>Ses pertes thermiques</p></li>
</ol>
<p>En jouant sur ces deux paramètres, il est possible de calculer la puissance solaire en entrée nécessaire, vis à vis du temps de chauffe, et ensuite le besoin pour le garder à la bonne température. Cela se base sur deux estimations, dont nous détaillons les calculs ci-dessous. Plusieurs questions que l’on peut se poser: Combien de temps mon four prendra-t-il à chauffer? Combien de temps restera-t-il chaud quand il n’y aura plus de soleil? Quels matériaux utiliser, quels sont leurs intérêts respectifs?</p>
<p>L’équation de base que l’on peut écrire, sous forme différentielle, est: <span class="math notranslate nohighlight">\(m*C_p*\frac{dT}{dt}=P_{in}-q_{pertes}(T)\)</span>, avec <span class="math notranslate nohighlight">\(m*C_p\)</span> le terme d’inertie thermique détaillé dans la section ci-dessous, <span class="math notranslate nohighlight">\(T\)</span> la temmpérature du four, <span class="math notranslate nohighlight">\(P_{in}\)</span> est la puissance en entrée (venant des miroirs), <span class="math notranslate nohighlight">\(q_{pertes}\)</span> correspond aux pertes thermiques du four.</p>
<p>Une bonne approximation de cette équation est: <span class="math notranslate nohighlight">\(m*C_p*\frac{\Delta T}{\Delta t} = P_{in}-q_{losses}(T)\)</span>, avec <span class="math notranslate nohighlight">\(\Delta T\)</span> la différence de température entre deux instants, chacun éloigné de <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>Il est à noter que cette équation marche pour tous les fours - on peut relier cela au préchauffage des fours traditionnels, ainsi que leur puissance et leur temps de chauffe, pour se faire une idée. Un four à pain traditionnel peut prendre jusqu’à trois jours pour chauffer! Une automatisation du tracking permettrait d’avoir accès à un four communale tournant la grande majorité du temps à l’énergie solaire, peut-être un jour?</p>
<div class="section" id="inertie-thermique">
<h3>Inertie thermique<a class="headerlink" href="#inertie-thermique" title="Permalink to this headline">¶</a></h3>
<p>Le terme d’inertie thermique correspond à <span class="math notranslate nohighlight">\(m*C_p\)</span>. <strong>m</strong> est la masse du four et <span class="math notranslate nohighlight">\(C_p\)</span> la capacité calorifique du matériau utilisé. Cette dernière correspond à l’énergie nécessaire (en joules) pour faire monter de 1°C un kilogramme de matériau. Quelques données, pour l’exemple: l’eau présente un <span class="math notranslate nohighlight">\(C_p=4187 J/kg.°C\)</span>, la terre présente un <span class="math notranslate nohighlight">\(C_p\)</span> d’environ <span class="math notranslate nohighlight">\(1000 J/kg.°C\)</span>, les roches montrent de grandes variations selon leur origine, mais leur <span class="math notranslate nohighlight">\(C_p\)</span> est en général entre 800 et 2400 J/kg.°C.</p>
<p>Pour calculer l’inertie thermique, il faut donc calculer les différentes masses et trouver sur internet leurs différentes capacités thermiques, puis sommer pour chaque matériau le produit des masses par leur <span class="math notranslate nohighlight">\(C_p\)</span>.</p>
<p><strong>Exemple:</strong> On prend un four, cubique, de côté 55cm, fait en terre avec une épaisseur de 5cm de terre. On commence par calculer le volume de terre: on prend donc le volume d’un cube de 55cm de côté, moins le volume d’un cube de 50cm (l’air au milieu). Cela donne: <span class="math notranslate nohighlight">\(V_{terre} = 0.55^3-0.5^3 = 0.041 m^3 = 41 L\)</span>. La masse de terre est alors: <span class="math notranslate nohighlight">\(m_{Terre} = \rho_{Terre}*V_{terre} = 1500 * 0.041 = 62 kg\)</span>. La masse volumique de la terre et sa capacité spécifique viennent d’<a class="reference external" href="https://fr.wikipedia.org/wiki/Terre_crue">ici</a>.</p>
<p>Sa chaleur spécifique est de <span class="math notranslate nohighlight">\(C_p=900 J/kg.°C\)</span>. Son inertie thermique s’évaluera alors comme: <span class="math notranslate nohighlight">\(I_t = m_{Terre}*C_p = 62*900 = 56 kJ/°C\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cCube</span> <span class="o">=</span> <span class="mf">0.55</span> <span class="c1">#en m</span>
<span class="n">eTerre</span><span class="o">=</span><span class="mf">0.05</span> <span class="c1">#en m</span>
<span class="n">VTerre</span><span class="o">=</span><span class="n">cCube</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="p">(</span><span class="n">cCube</span><span class="o">-</span><span class="n">eTerre</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="c1">#en m^3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Volume de terre: &quot;</span><span class="p">,</span> <span class="n">VTerre</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="s2">&quot; L&quot;</span><span class="p">)</span>
<span class="n">rhoTerre</span><span class="o">=</span><span class="mi">1500</span> <span class="c1">#en kg/m3</span>
<span class="n">mTerre</span><span class="o">=</span> <span class="n">rhoTerre</span><span class="o">*</span><span class="n">VTerre</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Masse de terre: &quot;</span><span class="p">,</span> <span class="n">mTerre</span><span class="p">,</span> <span class="s2">&quot; kg&quot;</span><span class="p">)</span>
<span class="n">CpTerre</span> <span class="o">=</span> <span class="mi">900</span>
<span class="n">ItFour</span> <span class="o">=</span> <span class="n">mTerre</span><span class="o">*</span><span class="n">CpTerre</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inertie du four: &quot;</span><span class="p">,</span> <span class="n">ItFour</span><span class="p">,</span> <span class="s2">&quot; J/°C&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Volume de terre:  41.37500000000005  L
Masse de terre:  62.06250000000008  kg
Inertie du four:  55856.25000000007  J/°C
</pre></div>
</div>
</div>
</div>
<p>Il faut donc amener 56kJ d’énergie pour faire monter de 1° le four.</p>
</div>
<div class="section" id="pertes-thermiques">
<h3>Pertes thermiques<a class="headerlink" href="#pertes-thermiques" title="Permalink to this headline">¶</a></h3>
<p>Ces pertes thermiques s’écrivent en général <span class="math notranslate nohighlight">\(U*A*(T_{four}-T_{ext})\)</span>. A est l’aire extérieure, facile à déterminer, et <span class="math notranslate nohighlight">\(\Delta T = T_{four}-T_{ext}\)</span> la différence de température entre l’intérieur du four et l’extérieur. U est le coefficient de pertes thermiques, en W/m².°C, plus difficile à déterminer: pour cela, il faut faire un calcul de résistance thermique, ce qui est fait classiquement via la relation:
<span class="math notranslate nohighlight">\(U = \frac{1}{R_{eq}} =  \frac{1}{\sum_i R_i}\)</span>.</p>
<p>Pour calculer les résistances thermiques, il faut connaître les conductivités <span class="math notranslate nohighlight">\(\lambda_i\)</span> des différentes couches de matériaux. Ensuite, chaque résistance s’écrira comme <span class="math notranslate nohighlight">\(\frac{e_i}{\lambda_i}\)</span> avec <span class="math notranslate nohighlight">\(e_i\)</span> l’épaisseur du matériau. Il faut également ajouter comme résistance thermique le coefficient de convection entre la paroi extérieur et l’air, noté <span class="math notranslate nohighlight">\(h_{ext}\)</span>. Ce dernier est en général égal à 10W/m².°C.</p>
<p>On obtient alors: <span class="math notranslate nohighlight">\(U= \frac{1}{ \frac{1}{h_{ext}}+\sum_i \frac{e_i}{\lambda_i}}\)</span></p>
<p>On peut alors calculer le temps de descente de la température si il n’y a pas de source de chaleur, ce qui équivaut à <span class="math notranslate nohighlight">\(P_{in}=0\)</span>: le temps caractéristique s’écrit <span class="math notranslate nohighlight">\(\tau = \frac{I_t}{UA}\)</span>, et la résolution de l’équation différentielle ci-dessus donne: <span class="math notranslate nohighlight">\(T=T_{ext}+(T_0-T_{ext})*\exp(-\frac{t}{\tau})\)</span>. Une estimation rapide de l’exponentielle nous permet de se dire que durant <span class="math notranslate nohighlight">\(\tau\)</span>, la différence de température sera divisé par 3.</p>
<p><strong>Exemple:</strong> Pour le four en terre défini ci-dessus, avec une conductivité de la terre valant <span class="math notranslate nohighlight">\(\lambda_{terre} = 0.7W/m.°C\)</span>, on obtient: <span class="math notranslate nohighlight">\(U = \frac{1}{\frac{1}{10}+\frac{0.05}{0.7}} = 5.8W/m².°C\)</span>
L’aire extérieure du four se calcule avec <span class="math notranslate nohighlight">\(A=6*c² = 1.8 m² \)</span>. On voit alors, que pour une différence de température de 150°C, il y aura une perte de <span class="math notranslate nohighlight">\(q_{pertes} = 1588W\)</span>. Pour garder ce four à cette  température, il faudra donc apporter 1.5 kW d’énergie thermique. Si on ne lui apporte plus de chaleur, il redescendra à une différence de température de 50°C au bout de : <span class="math notranslate nohighlight">\(\tau = 1.5h\)</span></p>
<p>Si l’on ajoute une couche de paille de 5cm isolant, on obtient alors de bien meilleurs résultats: en effet, la conductivité de la paille est de 0.052 W/m.°C, ce qui donne un temps caractéristique <span class="math notranslate nohighlight">\(\tau = 9.7h\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambdaTerre</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">ePaille</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">lambdaPaille</span><span class="o">=</span><span class="mf">0.052</span>
<span class="n">UFour</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="o">+</span><span class="n">eTerre</span><span class="o">/</span><span class="n">lambdaTerre</span><span class="o">+</span><span class="n">ePaille</span><span class="o">/</span><span class="n">lambdaPaille</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficient de pertes thermiques U: &quot;</span><span class="p">,</span><span class="n">UFour</span><span class="p">,</span> <span class="s2">&quot; W/m².°C&quot;</span><span class="p">)</span>
<span class="n">AFour</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">cCube</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aire extérieure du four A: &quot;</span><span class="p">,</span> <span class="n">AFour</span><span class="p">,</span> <span class="s2">&quot;m²&quot;</span><span class="p">)</span>
<span class="n">UA</span><span class="o">=</span><span class="n">UFour</span><span class="o">*</span><span class="n">AFour</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pertes thermiques du four: &quot;</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="s2">&quot;W/°C&quot;</span><span class="p">)</span>
<span class="n">deltaT</span><span class="o">=</span><span class="mi">150</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pertes à 150°C: &quot;</span><span class="p">,</span> <span class="n">UA</span><span class="o">*</span><span class="n">deltaT</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">)</span>
<span class="n">tau</span><span class="o">=</span><span class="n">ItFour</span><span class="o">/</span><span class="p">(</span><span class="n">UA</span><span class="p">)</span><span class="o">/</span><span class="mi">3600</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temps caractéristique: &quot;</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Coefficient de pertes thermiques U:  0.8826382153249271  W/m².°C
Aire extérieure du four A:  1.8150000000000004 m²
Pertes thermiques du four:  1.6019883608147432 W/°C
Pertes à 150°C:  240.29825412221146 W
Temps caractéristique:  9.6852295431841 h
</pre></div>
</div>
</div>
</div>
<div class="section" id="estimation-plus-precise">
<h4>Estimation plus précise<a class="headerlink" href="#estimation-plus-precise" title="Permalink to this headline">¶</a></h4>
<p><img alt="Four" src="../_images/fourSolaire.png" /></p>
<p>Il faut calculer pour chacun des côtés du four. A l’instant, le design envisagé est de mettre un four (cassé) avec le dos au soleil: il sera chauffé par la face arrière, le côté vitre classique conservera son rôle d’ouverture. Les trois autres côtés seront mis en masse (terre) et erenforcé en isolant. La face arrière sera elle dénudé, permettant une absorption de la chaleur solaire, et une diffuséion dans le four et la masse thermique. Une vitre sera déposé devant afin de servir d’isolant à la face arrière, fixé par le mélange de terre et paille utilisé comme masse et isolant.</p>
<p>Calcul des résistances thermiques des trois types de côtés:</p>
<ol class="simple">
<li><p>Face avant du four: pris <a class="reference external" href="http://www.vaucanson.org/php5/Accueil/index.php/comment-minimiser-les-pertes-d-energie/809-comment-estimer-la-resistance-thermique-du-four">ici</a>. Sa résistance thermique est de <span class="math notranslate nohighlight">\(R_{eq}=0.39 m².°C/W\)</span>, et donc de <span class="math notranslate nohighlight">\(U_{avant} = 2.5 W/m².°C\)</span>.</p></li>
<li><p>Face arrière du four: 1 épaisseur de verre - <span class="math notranslate nohighlight">\(\lambda_V = 1 W/M.°C\)</span>,<span class="math notranslate nohighlight">\(e_V=4mm\)</span> -, 3 interconnections avec l’air: métal-air,air-verre,verre-air, avec <span class="math notranslate nohighlight">\(h=10 W/m².°C\)</span>. D’où une résistance thermique de : <span class="math notranslate nohighlight">\(R_{eq} = 3*\frac{1}{h}+\frac{e_V}{\lambda_V} = 0.34 K.m²/W\)</span> et <span class="math notranslate nohighlight">\(U_{arrière} = \frac{1}{R_{eq}} = 2.94 W/m².°C\)</span>.</p></li>
<li><p>3 faces sur le côté enrobé dans de la terre, paille - pertes par radiation déjà isolée probablement. On suppose que la première isolation est de 0.1W/m².°C (souvent pas ouf). On part sur une épaisseur de terre de 5 cm et de 3cm de paille, ce qui donne:<span class="math notranslate nohighlight">\(R_{eq} = \frac{e_{terre}}{\lambda_{terre}}+\frac{e_{paille}}{\lambda_{paille}}=0.64°C.m²/WC\)</span> et donc <span class="math notranslate nohighlight">\(U_{cotes} = 1.54 W/m².°C\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_avant</span><span class="o">=</span><span class="mf">2.5</span>
<span class="n">U_arriere</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.04</span><span class="o">/</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">U_cotes</span><span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mf">0.05</span><span class="o">/</span><span class="n">lambdaTerre</span><span class="o">+</span><span class="mf">0.03</span><span class="o">/</span><span class="n">lambdaPaille</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calcul des différentes aires: Dimension du four -&gt; 45x27x38. Avec l’isolant: 65cmx48cmx27cm</p>
<ol class="simple">
<li><p>Face avant: <span class="math notranslate nohighlight">\(A_{avant} = 0.65*0.48=0.312m²\)</span></p></li>
<li><p>Face arrière: <span class="math notranslate nohighlight">\(A_{arrière} = A_{avant}\)</span></p></li>
<li><p>Les côtés: <span class="math notranslate nohighlight">\(A_{cotes} = 2*0.48*0.27+ 2*0.65*0.27=0.61 m²\)</span> - on suppose que le sol est isolé de la même manière que les côtés.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="mf">0.65</span> <span class="c1">#longueur rectangle de la porte</span>
<span class="n">l</span><span class="o">=</span><span class="mf">0.48</span> <span class="c1">#largeur rectangle de la porte</span>
<span class="n">p</span><span class="o">=</span><span class="mf">0.27</span> <span class="c1">#profondeur du four</span>
<span class="n">A_avant</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">l</span> 
<span class="n">A_arriere</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">l</span>
<span class="n">A_cotes</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">p</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aire avant &amp; arrière: &quot;</span><span class="p">,</span><span class="n">A_avant</span><span class="p">,</span><span class="s2">&quot;m² </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Aire des côtés: &quot;</span><span class="p">,</span> <span class="n">A_cotes</span><span class="p">,</span><span class="s2">&quot;m²&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Aire avant &amp; arrière:  0.312 m² 
 Aire des côtés:  0.6102000000000001 m²
</pre></div>
</div>
</div>
</div>
<p><strong>Calcul du coefficient UA du four</strong>: <span class="math notranslate nohighlight">\(UA= U_{avant}*A_{avant}+U_{arriere}*A_{arriere}+U_{cotes}*A_{cotes} = 1.9 W/°C \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">UA</span><span class="o">=</span><span class="n">U_avant</span><span class="o">*</span><span class="n">A_avant</span><span class="o">+</span><span class="n">U_arriere</span><span class="o">*</span><span class="n">A_arriere</span><span class="o">+</span><span class="n">U_cotes</span><span class="o">*</span><span class="n">A_cotes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;UA = &quot;</span><span class="p">,</span><span class="n">UA</span><span class="p">,</span><span class="s2">&quot; W/m².°C&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UA =  2.513039129308111  W/m².°C
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="estimation-de-la-puissance-d-entree">
<h3>Estimation de la puissance d’entrée<a class="headerlink" href="#estimation-de-la-puissance-d-entree" title="Permalink to this headline">¶</a></h3>
<p>La puissance d’entrée <span class="math notranslate nohighlight">\(P_{in}\)</span> doit être déterminée afin de savoir le nombre de miroirs nécessaires. On le fait à partir des données précédentes et des choix faits, en termes d’inertie thermique, et donc d’épaisseur et de la nature des matériaux, et également en température visée et temps de chauffe. Ce dernier dépend également du soleil arrivant sur le four!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mTerre</span><span class="o">=</span><span class="n">rhoTerre</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="mf">0.05</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">It</span><span class="o">=</span><span class="n">mTerre</span><span class="o">*</span><span class="n">CpTerre</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Masse de terre:&quot;</span><span class="p">,</span> <span class="n">mTerre</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Inertie thermique:&quot;</span><span class="p">,</span><span class="n">It</span><span class="p">,</span><span class="s2">&quot;J/°C&quot;</span><span class="p">)</span>
<span class="n">tau</span><span class="o">=</span><span class="n">It</span><span class="o">/</span><span class="n">UA</span><span class="o">/</span><span class="mi">3600</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temps caractéristique: &quot;</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="s2">&quot; h&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Masse de terre: 45.765 
 Inertie thermique: 41188.5 J/°C
Temps caractéristique:  4.552754418571271  h
</pre></div>
</div>
</div>
</div>
<p>A l’arrache, on peut prendre pour les pertes thermiques durant le taux de chauffe entre la différence de température au début et à la fin. On trouve alors <span class="math notranslate nohighlight">\(P_{in} = q_{pertes}+I_t * \frac{\Delta T}{\Delta t}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="n">T_four</span><span class="o">=</span> <span class="mi">200</span>
<span class="n">T_ext</span><span class="o">=</span><span class="mi">20</span>
<span class="n">qPertes</span><span class="o">=</span><span class="n">UA</span><span class="o">*</span><span class="p">(</span><span class="n">T_four</span><span class="o">-</span><span class="n">T_ext</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Les pertes thermiques moyennes sur la chauffe sont de: &quot;</span><span class="p">,</span> <span class="n">qPertes</span><span class="p">,</span><span class="s2">&quot; W&quot;</span><span class="p">)</span>
<span class="n">delta_t_Chauff</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="mi">3600</span> <span class="c1">#temps de chauffe du four en secondes à T_four</span>
<span class="n">qChauff</span><span class="o">=</span><span class="n">It</span><span class="o">*</span><span class="p">(</span><span class="n">T_four</span><span class="o">-</span><span class="n">T_ext</span><span class="p">)</span><span class="o">/</span><span class="n">delta_t_Chauff</span><span class="o">+</span><span class="n">qPertes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temps de chauffe: &quot;</span><span class="p">,</span><span class="n">delta_t_Chauff</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span><span class="s2">&quot; h</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Puissance de chauffe moyenne: &quot;</span><span class="p">,</span> <span class="n">qChauff</span><span class="p">,</span><span class="s2">&quot; W&quot;</span><span class="p">)</span>
<span class="n">P_helios</span> <span class="o">=</span> <span class="mi">600</span> <span class="c1">#W/m²: puissance moyenne arrivant des héliostats</span>
<span class="n">aire_heliostats</span> <span class="o">=</span> <span class="n">qChauff</span><span class="o">/</span><span class="n">P_helios</span> <span class="c1">#nombre d&#39;héliostats</span>
<span class="n">aire_1Helios</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">l</span>
<span class="n">cote_1Helios</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">aire_1Helios</span><span class="p">)</span>
<span class="n">nb_heliostats</span><span class="o">=</span> <span class="n">aire_heliostats</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Energie des héliostats estimée: &quot;</span><span class="p">,</span><span class="n">P_helios</span><span class="p">,</span><span class="s2">&quot; W/m² </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Aire d&#39;héliostats : &quot;</span><span class="p">,</span>
      <span class="n">aire_heliostats</span><span class="p">,</span><span class="s2">&quot; m²</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Nombre d&#39;héliostats: &quot;</span><span class="p">,</span><span class="n">nb_heliostats</span><span class="p">,</span> <span class="s2">&quot;avec une aire de &quot;</span><span class="p">,</span><span class="n">aire_1Helios</span><span class="p">,</span><span class="s2">&quot; m²&quot;</span><span class="p">,</span>
      <span class="s2">&quot;, ce qui donne un carré de &quot;</span><span class="p">,</span><span class="n">cote_1Helios</span><span class="p">,</span> <span class="s2">&quot; m de côté.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Les pertes thermiques moyennes sur la chauffe sont de:  226.17352163772998  W
Temps de chauffe:  3.0  h
 Puissance de chauffe moyenne:  912.64852163773  W
Energie des héliostats estimée:  600  W/m² 
 Aire d&#39;héliostats :  1.5210808693962168  m²
 Nombre d&#39;héliostats:  4.875259196782746 avec une aire de  0.312  m² , ce qui donne un carré de  0.5585696017507576  m de côté.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_helios</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Nombre d&#39;héliostats dans la suite du code</span>
</pre></div>
</div>
</div>
</div>
<p>10 héliostats de 0.3 m² semblent adapté à la situation calculé ci-dessus. <strong>Mesurer la taille de l’image pour savoir!!!!</strong></p>
</div>
</div>
<div class="section" id="methodologie-mathematique">
<h2>Méthodologie mathématique<a class="headerlink" href="#methodologie-mathematique" title="Permalink to this headline">¶</a></h2>
<div class="section" id="design-des-miroirs">
<h3>Design des miroirs<a class="headerlink" href="#design-des-miroirs" title="Permalink to this headline">¶</a></h3>
<p>Nous allons calculer la relation entre la longueur de la corde nécessaire pour connecter les deux bords. A voir distinction entre</p>
<p><img alt="heliostats" src="../_images/heliostats.png" /></p>
</div>
<div class="section" id="position-optimal-a-design-donne">
<h3>Position optimal à design donné<a class="headerlink" href="#position-optimal-a-design-donne" title="Permalink to this headline">¶</a></h3>
<p>Nous nous basons dans un repère <span class="math notranslate nohighlight">\((O,Ox,Oy,Oz)\)</span>. Le vecteur solaire <span class="math notranslate nohighlight">\(\vec{s}\)</span> est tel que décrit dans le chapitre Emplacement du soleil, calculable via l’algorithme PSA.</p>
<p>Nous allons distinguer deux cas: soit la machine est orienté vers le sud, soit la machine est orienté face au soleil, avec le four entre les deux.</p>
<div class="section" id="cas-1-machine-face-au-soleil">
<h4>Cas 1: Machine face au soleil<a class="headerlink" href="#cas-1-machine-face-au-soleil" title="Permalink to this headline">¶</a></h4>
<p>Cela revient à ce que le soleil soit situé au sud, avec la hauteur correspondante. On considère donc un repère qui aurait rotaté de manière à avoir le vecteur (Oy) le dos au soleil. Le vecteur solaire s’écrit alors <span class="math notranslate nohighlight">\(\vec{s} = \begin{pmatrix}
0 \\
-\cos(\gamma) \\
\sin(\gamma) \\
\end{pmatrix}\)</span>
avec <span class="math notranslate nohighlight">\(\gamma\)</span> l’élevation.</p>
<p>La suite de rotation à faire pour arriver dans la position voulue est:</p>
<ol class="simple">
<li><p>Rotation de <span class="math notranslate nohighlight">\(-\beta\)</span> autour de l’axe x. Cette base est la base <span class="math notranslate nohighlight">\(\mathbb{B}_1\)</span>.</p></li>
<li><p>Rotation de <span class="math notranslate nohighlight">\(+\alpha_i\)</span> autour de l’axe z. Cette base est la base <span class="math notranslate nohighlight">\(\mathbb{B}_2\)</span>.</p></li>
</ol>
<p>Les matrices de rotation donne <span class="math notranslate nohighlight">\(P_{01}=Mat_{\mathbb{B}_0}(\mathbb{B}_1) \,P_{12}=Mat_{\mathbb{B}_1}(\mathbb{B}_2)\)</span>.</p>
<p>D’où: <span class="math notranslate nohighlight">\(P_{01}=\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; \cos(\beta) &amp; -\sin(\beta) \\
0 &amp; \sin(\beta) &amp; \cos(\beta) \\
\end{pmatrix}\)</span></p>
<p>et <span class="math notranslate nohighlight">\(P_{12} = \begin{pmatrix}
\cos(\alpha_i) &amp; \sin(\alpha_i) &amp; 0 \\
-\sin(\alpha_i) &amp; \cos(\alpha_i) &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix}\)</span></p>
<p>La normale au panneau dans la base <span class="math notranslate nohighlight">\(\mathbb{B}_2\)</span> s’écrit: <span class="math notranslate nohighlight">\(\vec{n}_2 = \begin{pmatrix} 0 \\ -\sin(\beta_i) \\ \cos(\beta_i) \end{pmatrix}\)</span>
De <span class="math notranslate nohighlight">\(\vec{n}_2 = P_{01}*P_{12}*\vec{n}_0\)</span>, nous pouvons tirer: <span class="math notranslate nohighlight">\(\vec{n}_0=P_{21}*P_{10}*\vec{n}_2\)</span>, d’où:</p>
<p><span class="math notranslate nohighlight">\(\vec{n}_0=\begin{pmatrix}
-\sin(\alpha_i)*\cos(\beta+\beta_i) \\
-\cos(\alpha_i)*\cos(\beta+\beta_i) \\
\sin(\beta+\beta_i) \\
\end{pmatrix}
\)</span></p>
<p>Or la normale optimale au panneau (<span class="math notranslate nohighlight">\(\vec{n}_{opt,i}\)</span>) est le vecteur au milieu entre le vecteur solaire (<span class="math notranslate nohighlight">\(\vec{s}\)</span>) et le vecteur pointant sur la cible. Par conséquent, cela donne:
<span class="math notranslate nohighlight">\(\vec{n}_{opt,i} = \frac{\vec{s}+\vec{M_iT}/||g_i||}{2}\)</span> avec <span class="math notranslate nohighlight">\(g_i=||\vec{M_iT}||\)</span> la distance entre le miroir et la cible.</p>
<p>La position du centre du miroir: <span class="math notranslate nohighlight">\(M_i=(il,L+\mu \sin(\beta),h_0+\mu \cos(\beta)) \approx (il,L,h_0+\mu)\)</span>. i peut être négatif, sur le dessin varie de -2 à 2.</p>
<p>La position de la cible <span class="math notranslate nohighlight">\(T=(0,0,h)\)</span> - correspond au centre du four.</p>
<p>D’où: <span class="math notranslate nohighlight">\(\vec{n}_{opt,i} = \frac{1}{2} \begin{pmatrix}
-\frac{i*l}{g_i} \\
-\cos(\gamma)-\frac{L}{g_i} \\
\sin(\gamma)+\frac{h-h_0-\mu}{g_i}\\
\end{pmatrix}\)</span></p>
<p>On cherche maintenant le <span class="math notranslate nohighlight">\(\alpha_i\)</span> tel que la fonction <span class="math notranslate nohighlight">\(f_i: \alpha_i \to ||\vec{n}_{opt,i}-\vec{n}_{0,i}(\alpha_i)||²\)</span> soit minimisé. Cela donne:
$\frac{\partial f}{\partial \alpha_i} = \frac{1}{4</p>
</div>
<div class="section" id="cas-2-machine-et-four-fixe-oriente-sud">
<h4>Cas 2: Machine et four fixe - orienté sud<a class="headerlink" href="#cas-2-machine-et-four-fixe-oriente-sud" title="Permalink to this headline">¶</a></h4>
<p>Dans ce cas, le vecteur solaire prend toute sa forme: <span class="math notranslate nohighlight">\(\vec{s}=\begin{pmatrix} \sin(\alpha)*\cos(\gamma) \\
\cos(\alpha)*\cos(\gamma) \\
\sin(\gamma) \end{pmatrix}\)</span></p>
<p>La normale optimale s’écrit alors:
<span class="math notranslate nohighlight">\(\vec{n}_{opt,i} = \frac{1}{||\vec{s}+\vec{M_iT}/g_i||} \begin{pmatrix}
\sin(\alpha)*\cos(\gamma)-\frac{i*l}{g_i} \\
\cos(\alpha)*\cos(\gamma)-\frac{L}{g_i} \\
\sin(\gamma)+\frac{h-h_0-\mu}{g_i}\\
\end{pmatrix}\)</span></p>
<p>La normale s’écrit toujours: <span class="math notranslate nohighlight">\(\vec{n}_0=\begin{pmatrix}
-\sin(\alpha_i)*\cos(\beta+\beta_i) \\
-\cos(\alpha_i)*\cos(\beta+\beta_i) \\
\sin(\beta+\beta_i) \\
\end{pmatrix}
\)</span></p>
<p>On décide de designer pour un jour et une heure précise: cela permet d’obtenir les <span class="math notranslate nohighlight">\(\beta_i\)</span> par une expression régulière, ce qui est assez satisfaisant, ainsi que de fixer <span class="math notranslate nohighlight">\(\beta=0\)</span> à cette heure-là, correspondant à l’heure maximale d’utilisation.  de les fixer, puis de calculer les résultats (effet cosinus, spillage??). Il suffit pour cela de résoudre <span class="math notranslate nohighlight">\(\vec{n}_{opt,i}=\vec{n}_{0,i}\)</span></p>
<p>On obtient: <span class="math notranslate nohighlight">\(tan(\alpha_i) = \frac{\sin(\alpha)*\cos(\gamma)-i*l/g_i}{\cos(\alpha)*\cos(\gamma)-L/g_i}\)</span> et <span class="math notranslate nohighlight">\(\sin(\beta_i) = \sin(\gamma)+(h-h_0-d)/g_i\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sunvec</span><span class="o">=</span><span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">solarDeclinationByDayNumber</span><span class="p">(</span><span class="mi">120</span><span class="p">),(</span><span class="mi">15</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span><span class="mi">45</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">nopt</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">)</span>
<span class="n">alpha_i</span><span class="o">=</span><span class="n">atan</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">beta_i</span><span class="o">=</span><span class="n">asin</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.7386891890394839   -0.7386891890394838
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lBetaI</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="n">imax</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">nopt</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">)</span>
    <span class="n">lBetaI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asin</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=-</span><span class="mi">3</span>
<span class="n">sunvecTest</span><span class="o">=</span><span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">solarDeclinationByDayNumber</span><span class="p">(</span><span class="mi">140</span><span class="p">),(</span><span class="mi">15</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span><span class="mi">45</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="n">beta</span><span class="o">=</span><span class="n">optBeta</span><span class="p">(</span><span class="n">sunvecTest</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">)</span>
<span class="n">nopt</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvecTest</span><span class="p">)</span>
<span class="n">alpha_i</span><span class="o">=</span><span class="n">atan</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">realTarget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvecTest</span><span class="p">,</span><span class="n">alpha_i</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">imin</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.03940799,  0.0224391 ,  1.18021801])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span><span class="n">acos</span><span class="p">,</span><span class="n">atan2</span><span class="p">,</span><span class="n">asin</span>

<span class="k">class</span> <span class="nc">Target</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">position</span><span class="p">,</span><span class="n">lRectangle</span><span class="p">,</span><span class="n">LRectangle</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#position du centre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">=</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#idem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#idem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="c1">#idem en array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">lRectangle</span> <span class="c1">#largeur du rectangle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">LRectangle</span> <span class="c1">#Longueur du rectangle</span>

<span class="k">class</span> <span class="nc">Miroir</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">positionCentre</span><span class="p">,</span><span class="n">beta_i</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">lRectangle</span><span class="p">,</span><span class="n">LRectangle</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">positionCentre</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#position du centre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">=</span><span class="n">positionCentre</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#idem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="n">positionCentre</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#idem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positionCentre</span><span class="p">)</span> <span class="c1">#idem en array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_i</span><span class="o">=</span><span class="n">beta_i</span> <span class="c1">#angle de design incliné du miroir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">=</span><span class="n">target</span> <span class="c1">#cible (classe ci-dessus)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vecCible</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">])</span> <span class="c1">#vecteur cible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dCible</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vecCible</span><span class="p">)</span> <span class="c1">#distance à la cible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vecCibleUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vecCible</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dCible</span> <span class="c1">#vecteur cible unité</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_i</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c1">#angle de réglage de l&#39;azimuth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.</span> <span class="c1">#angle de réglage de la barre </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">lRectangle</span> <span class="c1">#largeur du rectangle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">LRectangle</span> <span class="c1">#Longueur du rectangle</span>
        
    <span class="c1">#Renvoie le vecteur héliostat-cible</span>
    <span class="k">def</span> <span class="nf">M_iT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">targ</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">targ</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">targ</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
    
    <span class="c1">#le même normé</span>
    <span class="k">def</span> <span class="nf">M_iTNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M_iT</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">vec</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>   
        
        <span class="c1">#Normale optimale du miroir</span>
    <span class="k">def</span> <span class="nf">n_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">npArr</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">M_iTNorm</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">vec</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
        
        <span class="c1">#normale du miroir</span>
    <span class="k">def</span> <span class="nf">n_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">coco</span><span class="o">=</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_i</span><span class="p">)</span>
        <span class="n">n0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">coco</span><span class="p">,</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">coco</span><span class="p">,</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_i</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">n0</span>
        
        <span class="c1">#cible du miroir</span>
    <span class="k">def</span> <span class="nf">realTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">n0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_0</span><span class="p">()</span>
        <span class="n">theta</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">acos</span><span class="p">(</span><span class="n">n0</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">npArr</span><span class="p">()))</span>
            <span class="c1">#On résoud le système d&#39;équations</span>
        <span class="n">ax</span><span class="o">=</span><span class="p">(</span><span class="n">n0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">sunvec</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">sunvec</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">sunvec</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="n">bx</span><span class="o">=-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">sunvec</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="n">az</span><span class="o">=-</span><span class="n">ax</span><span class="o">*</span><span class="n">n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">n0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">bz</span><span class="o">=-</span><span class="n">bx</span><span class="o">*</span><span class="n">n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">ax</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">az</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">az</span><span class="o">*</span><span class="n">bz</span><span class="o">+</span><span class="n">ax</span><span class="o">*</span><span class="n">bx</span><span class="p">)</span>
        <span class="n">c</span><span class="o">=</span><span class="n">bz</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">bx</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">c</span>
        <span class="n">uy</span><span class="o">=-</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
        <span class="n">ux</span><span class="o">=</span><span class="n">ax</span><span class="o">*</span><span class="n">uy</span><span class="o">+</span><span class="n">bx</span>
        <span class="n">uz</span><span class="o">=</span><span class="n">az</span><span class="o">*</span><span class="n">uy</span><span class="o">+</span><span class="n">bz</span>
        <span class="n">u</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ux</span><span class="p">,</span><span class="n">uy</span><span class="p">,</span><span class="n">uz</span><span class="p">])</span>
        <span class="n">tSurU</span><span class="o">=</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">tSurN</span><span class="o">=</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">tSurU</span><span class="o">*</span><span class="n">u</span><span class="o">+</span><span class="n">tSurN</span><span class="o">*</span><span class="n">n0</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dCible</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">posC</span>
        
        <span class="c1">#pertes cosinus par rapport au DNI</span>
    <span class="k">def</span> <span class="nf">cosineEfficiency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_0</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">npArr</span><span class="p">())</span>
        
    <span class="k">def</span> <span class="nf">isInRectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">point</span><span class="p">,</span><span class="n">posC</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
        <span class="k">if</span><span class="p">((</span><span class="n">posC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="o">&lt;</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="o">&gt;</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span> <span class="o">&gt;</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span> <span class="nf">countTrue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">listBool</span><span class="p">):</span>
        <span class="n">rez</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listBool</span><span class="p">)):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">listBool</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="n">rez</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">rez</span>
        
        <span class="c1">#pertes dues au spillage -- on vise à côté -&gt; renvoie 1 si tout est dedans, 0 si tout à l&#39;extérieur, </span>
        <span class="c1">#et taille du rectangle dans la cible divisé par taille du miroir si seulement une partie</span>
        <span class="c1">#taille de l&#39;image -&gt; supposé égale au miroir</span>
    <span class="k">def</span> <span class="nf">spillageEfficiency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">tPrime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">realTarget</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="n">TP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">tPrime</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tPrime</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="c1"># dans le plan (O,-x,z) -- comme si on était de face</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
        <span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="o">-</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span><span class="n">TP</span><span class="o">-</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">TP</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span><span class="n">TP</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">listRec</span><span class="o">=</span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">]</span>
        <span class="p">[</span><span class="n">AP</span><span class="p">,</span><span class="n">BP</span><span class="p">,</span><span class="n">CP</span><span class="p">,</span><span class="n">DP</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">TP</span><span class="o">-</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span><span class="n">TP</span><span class="o">-</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span><span class="n">TP</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span><span class="n">TP</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">listIm</span><span class="o">=</span><span class="p">[</span><span class="n">AP</span><span class="p">,</span><span class="n">BP</span><span class="p">,</span><span class="n">CP</span><span class="p">,</span><span class="n">DP</span><span class="p">]</span>
        <span class="n">areIn</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">point</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInRectangle</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="p">),</span><span class="n">listIm</span><span class="p">))</span> <span class="c1">#liste de booléens qui dit quels points sont dedans</span>
        <span class="n">combien</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countTrue</span><span class="p">(</span><span class="n">areIn</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">combien</span> <span class="o">==</span><span class="mi">0</span><span class="p">):</span> <span class="c1">#aucun point dans la cible</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">combien</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span> <span class="c1">#tout les points dedans</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">combien</span> <span class="o">==</span><span class="mi">1</span><span class="p">):</span> <span class="c1">#un point dedans</span>
            <span class="k">if</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">AP</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">BP</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">BP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">CP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">CP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">DP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">DP</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">combien</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span> <span class="c1">#deux points (forcément côte à côte) dedans</span>
            <span class="k">if</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">areIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">areIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">BP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">areIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">DP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">areIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">areIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">DP</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
            
        
        <span class="c1">#angle alpha optimal updaté</span>
    <span class="k">def</span> <span class="nf">optAlpha_i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">nopt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_opt</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_i</span><span class="o">=</span><span class="n">atan2</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_i</span>
    
    <span class="k">def</span> <span class="nf">optBeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">nopt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_opt</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_i</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
    
    <span class="k">def</span> <span class="nf">efficiency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosineEfficiency</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">spillageEfficiency</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">assemblageMiroir</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lMiroir</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span> <span class="o">=</span> <span class="n">lMiroir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NMir</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lMiroir</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">efficaciteSomme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">sum41</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="n">sum41</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">efficiency</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sum41</span>
    
    <span class="k">def</span> <span class="nf">setBeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">betaOut</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">betaOut</span>
            
    <span class="k">def</span> <span class="nf">optAlpha_is</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">optAlpha_i</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">choisirBeta_i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">beta_i</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">goodBetaI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">beta_i</span> <span class="o">=</span> <span class="n">goodBetaI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setBeta</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">lBetaI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">beta_i</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">optBeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
        <span class="n">somme</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span><span class="p">):</span>
            <span class="n">somme</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">lMir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="n">somme</span><span class="o">/=</span><span class="bp">self</span><span class="o">.</span><span class="n">NMir</span>
        <span class="n">maxVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">maxBeta</span> <span class="o">=</span> <span class="n">somme</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">somme</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="o">-</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBeta</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optAlpha_is</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
            <span class="n">eff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficaciteSomme</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">eff</span><span class="o">&gt;</span><span class="n">maxVal</span><span class="p">):</span>
                <span class="n">maxVal</span> <span class="o">=</span> <span class="n">eff</span>
                <span class="n">maxBeta</span> <span class="o">=</span> <span class="n">beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setBeta</span><span class="p">(</span><span class="n">maxBeta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optAlpha_is</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">maxVal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">targ</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.65</span><span class="p">)</span>
<span class="n">lMiroir</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">lMiroir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">lMiroir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">lMiroir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">assemblageMiroir</span><span class="p">(</span><span class="n">lMiroir</span><span class="p">)</span>
<span class="n">sunvect</span> <span class="o">=</span> <span class="n">solarVector</span><span class="p">()</span>
<span class="n">sunvect</span><span class="o">.</span><span class="n">setAzimElev</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">line</span><span class="o">.</span><span class="n">choisirBeta_i</span><span class="p">(</span><span class="n">sunvect</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sunvec</span> <span class="o">=</span> <span class="n">solarVector</span><span class="p">()</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">solarDeclinationByDayNumber</span><span class="p">(</span><span class="mi">172</span><span class="p">)</span>
<span class="n">listSV</span> <span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">listSV</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">delta</span><span class="p">,(</span><span class="n">h</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="mi">15</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span><span class="mi">45</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">))</span>
<span class="n">listVal</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listSV</span><span class="p">)):</span>
    <span class="n">listVal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">listSV</span><span class="p">[</span><span class="n">h</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.453092654324839, 5.999565211400075, 8.127386138163665, 12.671095308052664, 8.12738613816366, 5.999565211400078]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listVal2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.287846039649564,
 6.107527546078424,
 8.626078985183515,
 13.708576940652556,
 8.626078985183517,
 6.107527546078424]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]</span>
<span class="n">targ</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.65</span><span class="p">)</span>
<span class="n">lMiroir1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lMiroir2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lMiroir3</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">lMiroir1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">lMiroir2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">lMiroir3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Miroir</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="n">targ</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span>
<span class="n">line1</span> <span class="o">=</span> <span class="n">assemblageMiroir</span><span class="p">(</span><span class="n">lMiroir1</span><span class="p">)</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">assemblageMiroir</span><span class="p">(</span><span class="n">lMiroir2</span><span class="p">)</span>
<span class="n">line3</span> <span class="o">=</span> <span class="n">assemblageMiroir</span><span class="p">(</span><span class="n">lMiroir3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sunvect</span> <span class="o">=</span> <span class="n">solarVector</span><span class="p">()</span>
<span class="n">sunvect</span><span class="o">.</span><span class="n">setAzimElev</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">choisirBeta_i</span><span class="p">(</span><span class="n">sunvect</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">choisirBeta_i</span><span class="p">(</span><span class="n">sunvect</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">choisirBeta_i</span><span class="p">(</span><span class="n">sunvect</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sunvec</span> <span class="o">=</span> <span class="n">solarVector</span><span class="p">()</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">solarDeclinationByDayNumber</span><span class="p">(</span><span class="mi">172</span><span class="p">)</span>
<span class="n">listSV</span> <span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">listSV</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">delta</span><span class="p">,(</span><span class="n">h</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="mi">15</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span><span class="mi">45</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">))</span>
<span class="n">listVal</span><span class="o">=</span><span class="p">[]</span>
<span class="n">listVal2</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listSV</span><span class="p">)):</span>
    <span class="n">listVal</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line1</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">listSV</span><span class="p">[</span><span class="n">h</span><span class="p">]),</span><span class="n">line2</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">listSV</span><span class="p">[</span><span class="n">h</span><span class="p">]),</span><span class="n">line3</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">listSV</span><span class="p">[</span><span class="n">h</span><span class="p">])])</span>
    <span class="n">listVal2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">listVal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.752808921676912, 1.7956491117242106, 1.829608962372738], [2.06624428044501, 2.1018028496680556, 1.9657675946763882], [2.9725163008320887, 2.9371730196265466, 2.716389664724878], [4.773138557838215, 4.6380811506274835, 4.3115717107989004], [2.9725163008320883, 2.93717301962655, 2.7163896647248786], [2.06624428044501, 2.1018028496680556, 1.9657675946763882]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listVal2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.378066995773861,
 6.133814724789454,
 8.626078985183515,
 13.722791419264599,
 8.626078985183517,
 6.133814724789454]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">n_opt</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.13769109, -0.54801507,  0.82505796])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">optBeta</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">beta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.18490661231117533
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">optAlpha_i</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
<span class="n">miro</span><span class="o">.</span><span class="n">alpha_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.895433907860867
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">n_0</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.13769109, -0.54801507,  0.82505796])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">miro</span><span class="o">.</span><span class="n">efficiency</span><span class="p">(</span><span class="n">sunvec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9709092545162576
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">atan</span><span class="p">,</span><span class="n">acos</span>
<span class="n">lHe</span><span class="o">=</span> <span class="n">L</span> <span class="c1">#écart entre les centres des héliostats</span>
<span class="n">LHe</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#écart entre barre et cible</span>
<span class="n">hTarget</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># hauteur de la cible </span>
<span class="n">h_0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># hauteur de la barre</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#hauteur du support des héliostats</span>
<span class="n">imin</span><span class="o">=-</span><span class="mi">3</span>
<span class="n">imax</span><span class="o">=</span><span class="mi">3</span>
<span class="n">lat</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="c1">#latitude</span>



<span class="c1">#renvoie la distance héliostat-cible&quot;</span>
<span class="k">def</span> <span class="nf">g_i</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M_iT</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>



<span class="c1">#normale optimale du miroir au vu de la cible</span>
<span class="k">def</span> <span class="nf">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">):</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">npArr</span><span class="p">()</span><span class="o">+</span><span class="n">M_iTNorm</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">vec</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>


    
<span class="c1">#normale en fonction de l&#39;inclinaison</span>
<span class="k">def</span> <span class="nf">n_0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">alpha_i</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">beta_i</span><span class="p">):</span>
    <span class="n">coco</span><span class="o">=</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="o">+</span><span class="n">beta_i</span><span class="p">)</span>
    <span class="n">n0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">coco</span><span class="p">,</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">coco</span><span class="p">,</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="o">+</span><span class="n">beta_i</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">n0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">3744e0</span><span class="n">a41572</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">atan</span><span class="p">,</span><span class="n">acos</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">lHe</span><span class="o">=</span> <span class="n">L</span> <span class="c1">#écart entre les centres des héliostats</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">LHe</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#écart entre barre et cible</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">hTarget</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># hauteur de la cible</span>

<span class="ne">NameError</span>: name &#39;L&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#coût par miroir (à minimiser)</span>
<span class="k">def</span> <span class="nf">costPerM</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">,</span><span class="n">alpha_i</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">beta_i</span><span class="p">):</span>
    <span class="n">diff</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">alpha_i</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">beta_i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>

<span class="c1"># coût par ligne (à minimiser)</span>
<span class="k">def</span> <span class="nf">costPerLine</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">):</span>
    <span class="n">sumTot</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1">#sunvec.printVec()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="n">imax</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">nopt</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="n">alpha_i</span><span class="o">=</span><span class="n">atan</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#print(i,&quot; ---&gt; &quot;,costPerM(i,sunvec,alpha_i,beta,lBetaI[i]))</span>
        <span class="n">sumTot</span><span class="o">+=</span><span class="n">costPerM</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">,</span><span class="n">alpha_i</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sumTot</span>

<span class="c1">#Approximation de la meilleure position de la barre comme moyenne des meilleures positions par héliostats</span>
<span class="k">def</span> <span class="nf">optBetaApprox</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">):</span>
    <span class="n">sumTot</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="n">imax</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">nopt</span><span class="o">=</span><span class="n">n_opt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sunvec</span><span class="p">)</span>
        <span class="n">alpha_i</span><span class="o">=</span><span class="n">atan</span><span class="p">(</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">mu_i</span><span class="o">=</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">nopt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha_i</span><span class="p">)</span><span class="o">*</span><span class="n">nopt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sumTot</span><span class="o">+=</span><span class="n">acos</span><span class="p">((</span><span class="n">nopt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">mu_i</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">lBetaI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sumTot</span><span class="o">/</span><span class="p">(</span><span class="n">imax</span><span class="o">-</span><span class="n">imin</span><span class="p">)</span>

<span class="c1">#Angle optimal de contrôle</span>
<span class="k">def</span> <span class="nf">optBeta</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">costForControl</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">costPerLine</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">costForControl</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nelder-mead&#39;</span><span class="p">,</span>
               <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xatol&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#fonction coût pour le design</span>
<span class="k">def</span> <span class="nf">costForDesign</span><span class="p">(</span><span class="n">lBetaI</span><span class="p">):</span>
    <span class="n">days</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
    <span class="n">hours</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">sumTot</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">hours</span><span class="p">:</span>
            <span class="n">sunvec</span> <span class="o">=</span> <span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">solarDeclinationByDayNumber</span><span class="p">(</span><span class="n">day</span><span class="p">),</span><span class="mi">15</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="p">(</span><span class="n">hour</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span><span class="n">lat</span><span class="p">)</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">optBeta</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">)</span>
            <span class="n">sumTot</span><span class="o">+=</span><span class="n">costPerLine</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">lBetaI</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sumTot</span>

<span class="n">costForDesign</span><span class="p">([</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="n">imax</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5105407170466245
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span><span class="n">asin</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span><span class="n">atan2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">class</span> <span class="nc">solarVector</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">lat</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">long</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">=</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="n">z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span> <span class="c1">#latitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="n">long</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="o">=</span><span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="o">=</span><span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">declin</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hourAngle</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="p">)</span><span class="o">=</span><span class="n">azimElevFromSolarVector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">hourAngle</span><span class="p">)</span><span class="o">=</span><span class="n">declinHourFromSolarVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="mi">12</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hourAngle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="mi">15</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
        <span class="n">rez</span><span class="o">=</span><span class="s2">&quot;x---&gt;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, y---&gt;&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, z---&gt; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">rez</span><span class="o">+=</span><span class="s2">&quot;azimuth -&gt; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;° , elevation -&gt; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;° </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">rez</span><span class="o">+=</span><span class="s2">&quot;Declination -&gt; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declin</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;°, hour angle -&gt; &quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hourAngle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;° </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">rez</span>
        
    <span class="k">def</span> <span class="nf">npArr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">printAzimElev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;azimuth ---&gt;&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;°  , elevation---&gt; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;°&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">printDeclinHour</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;declinaison ---&gt;&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;°  , Angle horaire ---&gt; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;°&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">azimElev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">azim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">elev</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">setAzimElev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">azim</span><span class="p">,</span><span class="n">elev</span><span class="p">):</span>
        <span class="n">lol</span> <span class="o">=</span> <span class="n">solarVectorFromAzimElev</span><span class="p">(</span><span class="n">azim</span><span class="p">,</span><span class="n">elev</span><span class="p">)</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lol</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">z</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setDeclinHour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">declin</span><span class="p">,</span> <span class="n">hour</span><span class="p">):</span>
        <span class="n">lol</span> <span class="o">=</span> <span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">declin</span><span class="p">,</span><span class="n">hour</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lol</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">z</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">declinHour</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dateNow</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="n">lol</span> <span class="o">=</span> <span class="n">sunPosPSA</span><span class="p">(</span><span class="n">dateNow</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lol</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">lol</span><span class="o">.</span><span class="n">z</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">solarVectorFromAzimElev</span><span class="p">(</span><span class="n">azim</span><span class="p">,</span><span class="n">elev</span><span class="p">):</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">azim</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">elev</span><span class="p">);</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">azim</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">elev</span><span class="p">);</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">elev</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">solarVector</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">sz</span><span class="p">);</span>


<span class="k">def</span> <span class="nf">azimElevFromSolarVector</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">elev</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">z</span><span class="p">);</span>
    <span class="n">interm</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">cos</span><span class="p">(</span><span class="n">elev</span><span class="p">)</span><span class="o">-</span><span class="mf">0.00000000000002</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">azim</span> <span class="o">=</span> <span class="n">interm</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">azim</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">+</span> <span class="n">interm</span><span class="p">;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">azim</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">interm</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">azim</span><span class="p">,</span><span class="n">elev</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">solarDeclinationByDayNumber</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
    <span class="n">Pi</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="p">;</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">365</span> <span class="o">*</span> <span class="p">(</span><span class="n">day</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">);</span>
    <span class="k">return</span> <span class="mf">0.006918</span> <span class="o">-</span> <span class="mf">0.399912</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.006758</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.000907</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.002697</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00148</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">omega</span><span class="p">);</span>

<span class="k">def</span> <span class="nf">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">declination</span><span class="p">,</span><span class="n">hourAngle</span><span class="p">,</span><span class="n">lat</span><span class="p">):</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">declination</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">hourAngle</span><span class="p">);</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">declination</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">declination</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">hourAngle</span><span class="p">);</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">declination</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">declination</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">hourAngle</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">solarVector</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">sz</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">declinHourFromSolarVector</span><span class="p">(</span><span class="n">sunvec</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">declin</span> <span class="o">=</span> <span class="n">asin</span><span class="p">((</span><span class="n">sunvec</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="n">sunvec</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">tan</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan</span><span class="p">(</span><span class="n">lat</span><span class="p">)));</span>
    <span class="n">interm</span> <span class="o">=</span> <span class="o">-</span><span class="n">asin</span><span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">cos</span><span class="p">(</span><span class="n">declin</span><span class="p">));</span>
    <span class="n">test</span> <span class="o">=</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">declin</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">-</span> <span class="n">sunvec</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">declin</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">interm</span><span class="p">)</span> <span class="o">-</span> <span class="n">test</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">):</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="n">interm</span><span class="p">;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">sunvec</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">interm</span><span class="p">;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span> <span class="o">-</span> <span class="n">interm</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">declin</span><span class="p">,</span><span class="n">hour</span><span class="p">)</span>

<span class="c1">#Algorithme PSA, updaté avec les dernières valeurs de Blanco et al.</span>
<span class="k">def</span> <span class="nf">sunPosPSA</span><span class="p">(</span><span class="n">dateUTC</span><span class="p">,</span>  <span class="n">dLongitude</span><span class="p">,</span>  <span class="n">dLatitude</span><span class="p">):</span>
    <span class="p">[</span><span class="n">iYear</span><span class="p">,</span> <span class="n">iMonth</span><span class="p">,</span><span class="n">iDay</span><span class="p">,</span> <span class="n">dHours</span><span class="p">,</span> <span class="n">dMinutes</span><span class="p">,</span>  <span class="n">dSeconds</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">day</span><span class="p">,</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span><span class="n">dateUTC</span><span class="o">.</span><span class="n">second</span><span class="p">]</span>
    <span class="n">dDecimalHours</span> <span class="o">=</span> <span class="n">dHours</span> <span class="o">+</span> <span class="p">(</span><span class="n">dMinutes</span><span class="o">+</span> <span class="n">dSeconds</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">;</span>
    <span class="c1"># Calculate current Julian Day</span>
    <span class="n">liAux1</span> <span class="o">=</span> <span class="p">(</span><span class="n">iMonth</span> <span class="o">-</span> <span class="mi">14</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">;</span>
    <span class="n">liAux2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1461</span> <span class="o">*</span> <span class="p">(</span><span class="n">iYear</span> <span class="o">+</span> <span class="mi">4800</span> <span class="o">+</span> <span class="n">liAux1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="mi">367</span> <span class="o">*</span> <span class="p">(</span><span class="n">iMonth</span><span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">liAux1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">12</span>  \
        <span class="o">-</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">((</span><span class="n">iYear</span> <span class="o">+</span> <span class="mi">4900</span><span class="o">+</span> <span class="n">liAux1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span><span class="n">iDay</span> <span class="o">-</span> <span class="mi">32075</span><span class="p">;</span>
    <span class="n">dJulianDate</span> <span class="o">=</span> <span class="p">(</span><span class="n">liAux2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">dDecimalHours</span> <span class="o">/</span> <span class="mf">24.0</span><span class="p">;</span>
    <span class="c1"># Calculate difference between current Julian Day and JD 2451545.0 </span>
    <span class="n">dElapsedJulianDays</span> <span class="o">=</span> <span class="n">dJulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">;</span>
    

    <span class="c1"># Calculate ecliptic coordinates (ecliptic longitude and obliquity of the </span>
    <span class="c1"># ecliptic in radians but without limiting the angle to be less than 2*Pi </span>
    <span class="c1"># (i.e., the result may be greater than 2*Pi)</span>
    
    <span class="n">dOmega</span> <span class="o">=</span> <span class="mf">2.267127827</span> <span class="o">-</span> <span class="mf">9.300339267</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">dElapsedJulianDays</span><span class="p">;</span>
    <span class="n">dMeanLongitude</span> <span class="o">=</span> <span class="mf">4.895036035</span> <span class="o">+</span> <span class="mf">0.01720279602</span> <span class="o">*</span> <span class="n">dElapsedJulianDays</span><span class="p">;</span> <span class="c1"># Radians</span>
    <span class="n">dMeanAnomaly</span> <span class="o">=</span> <span class="mf">6.239468336</span> <span class="o">+</span> <span class="mf">0.01720200135</span> <span class="o">*</span> <span class="n">dElapsedJulianDays</span><span class="p">;</span>
    <span class="n">dEclipticLongitude</span> <span class="o">=</span> <span class="n">dMeanLongitude</span> <span class="o">+</span> <span class="mf">0.03338320972</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">dMeanAnomaly</span><span class="p">)</span> \
            <span class="o">+</span> <span class="mf">0.0003497596876</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dMeanAnomaly</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.0001544353226</span> \
            <span class="o">-</span> <span class="mf">8.689729360</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">dOmega</span><span class="p">);</span>
    <span class="n">dEclipticObliquity</span> <span class="o">=</span> <span class="mf">0.4090904909</span> <span class="o">-</span> <span class="mf">6.213605399</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">dElapsedJulianDays</span> \
            <span class="o">+</span> <span class="mf">4.418094944</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">dOmega</span><span class="p">);</span>


    <span class="c1"># Calculate celestial coordinates ( right ascension and declination ) in radians </span>
    <span class="c1"># but without limiting the angle to be less than 2*Pi (i.e., the result may be </span>
    <span class="c1"># greater than 2*Pi)</span>
    
    <span class="n">dSin_EclipticLongitude</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">dEclipticLongitude</span><span class="p">);</span>
    <span class="n">dY</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">dEclipticObliquity</span><span class="p">)</span> <span class="o">*</span> <span class="n">dSin_EclipticLongitude</span><span class="p">;</span>
    <span class="n">dX</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">dEclipticLongitude</span><span class="p">);</span>
    <span class="n">dRightAscension</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">dY</span><span class="p">,</span> <span class="n">dX</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dRightAscension</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="n">dRightAscension</span> <span class="o">=</span> <span class="n">dRightAscension</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">;</span>
    <span class="n">dDeclination</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">dEclipticObliquity</span><span class="p">)</span> <span class="o">*</span> <span class="n">dSin_EclipticLongitude</span><span class="p">);</span>
    

    <span class="c1"># Calculate solar vector</span>
    
    <span class="n">dGreenwichMeanSiderealTime</span> <span class="o">=</span> <span class="mf">6.697096103</span> <span class="o">+</span><span class="mf">0.06570984737</span> <span class="o">*</span> <span class="n">dElapsedJulianDays</span><span class="o">+</span> <span class="n">dDecimalHours</span><span class="p">;</span>
    <span class="n">dLocalMeanSiderealTime</span> <span class="o">=</span> <span class="p">(</span><span class="n">dGreenwichMeanSiderealTime</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span><span class="o">+</span> <span class="n">dLongitude</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">dHourAngle</span> <span class="o">=</span> <span class="n">dLocalMeanSiderealTime</span> <span class="o">-</span> <span class="n">dRightAscension</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">solarVectorFromDeclinHour</span><span class="p">(</span><span class="n">dDeclination</span><span class="p">,</span> <span class="n">dHourAngle</span><span class="p">,</span> <span class="n">dLatitude</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lol</span><span class="o">=</span><span class="n">solarVector</span><span class="p">()</span>
<span class="n">lol</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x---&gt;-0.42567477528617065, y---&gt;-0.29356455946568655, z---&gt; 0.8559327281456093
azimuth -&gt; 235.40809907862774° , elevation -&gt; 58.86293182528828° 
Declination -&gt; 23.43162195874746°, hour angle -&gt; 27.641180474871458° 
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Part2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By SolarPunk 73<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>